-- Load WindUI
local WindUI = loadstring(game:HttpGet(
    "https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"
))()

-- Window
local Window = WindUI:CreateWindow({
    Title = "Solo Hunters Felon HUB (Premium)",
    Icon = "user",
    Author = "https://discord.gg/AXTKtmUvyf",
    OpenButton = {
        Title = "Felon HUB",
        Icon = "monitor",
        Enabled = true,
        Draggable = true,
    }
})

local Main = Window:Tab({
    Title = "Main",
    Icon = "home", -- เปลี่ยน Icon เป็นชื่อที่ Library รองรับ
})

local VirtualUser = game:GetService("VirtualUser")
_G.AutoClick = false -- ตั้งต้นให้เป็น false ไว้ก่อน

-- ฟังก์ชันสำหรับคลิก
local function DoClick()
    task.spawn(function()
        while _G.AutoClick do
            pcall(function()
                VirtualUser:CaptureController()
                VirtualUser:ClickButton1(Vector2.new(0, 0))
            end)
            task.wait(0.1) -- ความเร็วในการกด
        end
    end)
end

Main:Toggle({
    Title = "Auto Attack",
    Desc = "Auto hit (Sword)",
    Value = false,
    Callback = function(v)
        _G.AutoClick = v -- กำหนดค่าตามปุ่ม Toggle (true หรือ false)
        if v then
            DoClick() -- ถ้าเปิด ให้เริ่มทำงาน
            print("Auto Clicker: ON")
        else
            print("Auto Clicker: OFF")
        end
    end
})
Main:Button({
    Title = "Auto Quest",
    Desc = "Auto Task",
    Callback = function()
        local questName = "Subway" -- เปลี่ยนชื่อเควสตรงนี้จุดเดียวพอ

        local rs = game:GetService("ReplicatedStorage")
        local questRF = rs:WaitForChild("RemoteServices")
            :WaitForChild("QuestsV2Service")
            :WaitForChild("RF")
            :WaitForChild("RequestQuest")

        -- กันกดรัว
        if _G.RequestingQuest then return end
        _G.RequestingQuest = true

        -- ยิงแบบกันพัง
        local success, result = pcall(function()
            return questRF:InvokeServer(questName)
        end)

        if success then
            print("รับเควสสำเร็จ:", result)
        else
            warn("รับเควสไม่สำเร็จ:", result)
        end

        task.wait(1)
        _G.RequestingQuest = false
    end
})
--// ===== SETUP ครั้งเดียวพอ =====
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local RemoteServices = ReplicatedStorage:WaitForChild("RemoteServices")
local DungeonService = RemoteServices:WaitForChild("DungeonService")
local RF = DungeonService:WaitForChild("RF")
local StartDungeon = RF:WaitForChild("StartDungeon") -- RemoteFunction


-- ฟังก์ชันเริ่มดันเจี้ยน
local function startDungeon()
    local success, result = pcall(function()
        return StartDungeon:InvokeServer()
    end)

    if success then
        print("Dungeon Started:", result)
    else
        warn("Dungeon Error:", result)
    end
end


--// ===== UI BUTTON =====
Main:Button({
    Title = "Start Dungeon",
    Desc = "Start the dungeon once",
    Callback = function()
        startDungeon()
    end
})
Main:Toggle({
    Title = "Auto Attack",
    Desc = "Auto hit (Sword)",
    Value = false,
    Callback = function(v)
local player = game.Players.LocalPlayer
local runService = game:GetService("RunService")

-- การตั้งค่า
local MAX_DISTANCE = 500
local HEIGHT_ABOVE = 10 

-- สร้างแรงยกเพื่อให้นิ่ง (BodyVelocity)
local bv = Instance.new("BodyVelocity")
bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge) -- ใช้แรงมหาศาลเพื่อสู้กับแรงโน้มถ่วง
bv.Velocity = Vector3.new(0, 0, 0) -- ล็อคความเร็วเป็น 0 เพื่อให้นิ่งสนิท

function isMonster(model)
    if model:IsA("Model") and model:FindFirstChild("Humanoid") and model ~= player.Character then
        if not game.Players:GetPlayerFromCharacter(model) then
            return true
        end
    end
    return false
end

function getClosestMonster()
    local closestTarget = nil
    local shortestDistance = MAX_DISTANCE
    local myHRP = player.Character and player.Character:FindFirstChild("HumanoidRootPart")

    if not myHRP then return nil end

    for _, obj in pairs(game.Workspace:GetDescendants()) do
        if isMonster(obj) then
            local targetHRP = obj:FindFirstChild("HumanoidRootPart")
            if targetHRP then
                local distance = (myHRP.Position - targetHRP.Position).Magnitude
                if distance <= shortestDistance then
                    closestTarget = targetHRP
                    shortestDistance = distance
                end
            end
        end
    end
    return closestTarget
end

-- ฟังก์ชันที่ทำให้ลอยนิ่ง
runService.RenderStepped:Connect(function()
    local target = getClosestMonster()
    local character = player.Character
    local myHRP = character and character:FindFirstChild("HumanoidRootPart")

    if target and myHRP then
        -- ใส่ BodyVelocity เข้าไปในตัวถ้ายังไม่มี
        if bv.Parent ~= myHRP then
            bv.Parent = myHRP
        end

        -- วาร์ปไปตำแหน่งเหนือหัว
        local targetPos = target.Position
        myHRP.CFrame = CFrame.new(targetPos.X, targetPos.Y + HEIGHT_ABOVE, targetPos.Z)
    else
        -- ถ้าไม่มีมอนสเตอร์ ให้เอาแรงยกออกเพื่อให้ตกลงมาปกติ (หรือจะให้ลอยค้างไว้ก็ได้)
        bv.Parent = nil
    end
end)
)}